/*! jQuery-USOS 1.4.0 -- https://github.com/MUCI/jquery-usos */
(function(g){var d="usosCore";var e={settings:null,preloaderElement:null,unloading:false};var m=function(n){if(e.settings!==null){g.usosCore._console.error("jQuery.usosCore is already initialized! Subsequent calls to init will be ingored!");return}var o={debug:false,langpref:"en",usosAPIs:{"default":{methodUrl:null,extraParams:{},user_id:null}},entityURLs:{},panicCallback:null,_requestDelay:0};e.settings=g.extend(true,{},o,n);e.preloaderElement=g("<div style='display: none'>");g(function(){g(document.body).append(e.preloaderElement);g(window).on("beforeunload",function(){e.unloading=true})})};var f=function(p){var q={};var n=false;g.each(p,function(r,s){if(g.isArray(s)){s=s.join("|")}else{if(typeof s!=="string"){if(File&&File.prototype.isPrototypeOf(s)){n=true}else{s=""+s}}}q[r]=s});if(!n){return q}var o=new FormData();g.each(q,function(r,s){o.append(r,s)});return o};var c=function(n){var r={source_id:"default",method:"method_name",params:{},syncMode:"noSync",syncObject:null,success:null,error:null,errorOnUnload:false};var x=g.extend({},r,n);if(x.syncMode=="noSync"){if(x.syncObject!==null){throw ("syncObject must stay null if syncMode is 'noSync'")}}else{if((x.syncMode=="receiveLast")||(x.syncMode=="receiveIncrementalFast")){if(x.syncObject===null){throw ("syncObject must be an object if syncMode is other than 'noSync'. Check out the docs!")}}else{throw ("Invalid syncMode: "+x.syncMode)}}var p=null;if(x.syncObject!==null){if(typeof x.syncObject.lastIssuedRequestId==="undefined"){x.syncObject.lastIssuedRequestId=0;x.syncObject.lastReceivedRequestId=0}x.syncObject.lastIssuedRequestId++;p=x.syncObject.lastIssuedRequestId}var o=e.settings.usosAPIs[x.source_id].methodUrl.replace("%s",x.method);var q=g.extend({},x.params,e.settings.usosAPIs[x.source_id].extraParams);var w=g.Deferred();var u=function(z,A,y){if(x.syncObject!==null){if(x.syncObject.lastReceivedRequestId>p){return}if((x.syncMode=="receiveLast")&&p<x.syncObject.lastIssuedRequestId){return}x.syncObject.lastReceivedRequestId=p}if(x.success!==null){x.success(z)}w.resolve(z)};var t=function(C,B,z){if(x.syncObject!==null){if(x.syncObject.lastReceivedRequestId>p){return}x.syncObject.lastReceivedRequestId=p}var y;try{if(C&&C.responseText){y=g.parseJSON(C.responseText)}else{throw"Missing responseText"}}catch(A){y={message:"USOS API communication error."};if(C.status!=0){g.usosCore._console.error("usosapiFetch: Failed to parse the error response: ",A)}}y.xhr=C;y.xhr.usosapiFetchOptions=x;if((C.status==0)&&e.unloading&&(!x.errorOnUnload)){}else{if(x.error!==null){x.error(y)}w.reject(y)}};var v={type:"POST",url:o,data:f(q),dataType:"json",success:u,error:t};if(FormData&&FormData.prototype.isPrototypeOf(v.data)){v.contentType=false;v.processData=false}var s=null;if(e.settings._requestDelay!=0){s=setTimeout(function(){s=g.ajax(v)},e.settings._requestDelay)}else{s=g.ajax(v)}if(x.syncMode=="noSync"){return w.promise({abort:function(){if(s.abort){s.abort()}else{clearTimeout(s)}}})}};var b=function(){if(arguments.length==1){if(arguments[0]===null){return b({langdict:{pl:null,en:null}})}else{if(typeof arguments[0].langdict!=="undefined"){}else{if((typeof arguments[0].pl!=="undefined")||(typeof arguments[0].en!=="undefined")){return b({langdict:arguments[0]})}else{return b(arguments[0],arguments[0])}}}}else{if(arguments.length==2){return b({langdict:{pl:arguments[0],en:arguments[1]}})}else{if(arguments.length==0){return e.settings.langpref}else{throw ("Invalid arguments")}}}var o={langdict:null,langpref:"inherit",wrapper:"simple"};var r=g.extend({},o,arguments[0]);if(r.langpref=="inherit"){r.langpref=e.settings.langpref}var s,q,p;if(typeof r.langdict!=="object"){s=r.langdict;q=r.langdict}else{s=r.langdict.pl;q=r.langdict.en}if(r.wrapper=="none"){if(r.langpref=="pl"){return s}else{return q}}else{if(r.wrapper=="simple"){if(r.langpref=="pl"){if(s){p=s}else{if(q){p="(po angielsku) "+q}else{p="(brak danych)"}}}else{if(q){p=q}else{if(s){p="(in Polish) "+s}else{p="(unknown)"}}}return p}else{if((r.wrapper=="jQuery.text")||(r.wrapper=="jQuery.html")){var n,t;if(r.wrapper=="jQuery.html"){n="<div>";t="html"}else{n="<span>";t="text"}p=g(n);if(r.langpref=="pl"){if(s){p[t](s)}else{if(q){p.append(g(n).addClass("ua-note").text("(po angielsku)")).append(" ").append(g(n)[t](q))}else{p.append(g(n).addClass("ua-note").text("(brak danych)"))}}}else{if(q){p[t](q)}else{if(s){p.append(g(n).addClass("ua-note").text("(in Polish)")).append(" ").append(g(n)[t](s))}else{p.append(g(n).addClass("ua-note").text("(unknown)"))}}}return p}else{g.usosCore._console.error("Unknown wrapper "+r.wrapper+", assuming 'default'.");r.wrapper="default";return b(r)}}}};var i=function(s,p,o,n,t,r){if(e.settings.langpref=="pl"){if(s==1){return p}var u=s%10;var q=s%100;if((q>=12)&&(q<=14)){return n}if((u>=2)&&(u<=4)){return o}return n}else{if(s==1){return t}return r}};var j=function(){var o=function(q){if(typeof q==="object"){return g.extend(true,{},q)}else{return q}};var p=function(q){var s=[];for(var r=0;r<q.length;r++){s.push(o(q[r]))}return s};var n={};g.each(["log","warn","error","assert"],function(q,r){n[r]=function(){if(e.settings.debug&&window.console&&window.console[r]){Function.prototype.apply.call(window.console[r],window.console,p(arguments))}}});return n}();var a=function(p){var x=g.Deferred();var n;var o=g("<div class='ua-paragraphs ua-container'>");if(typeof p==="object"&&p.user_messages){n=0;var q=[];if(p.user_messages.generic_message){q.push(p.user_messages.generic_message)}if(p.user_messages.fields){g.each(p.user_messages.fields,function(y,z){q.push(z)})}g.each(q,function(y,z){o.append(g("<p style='font-size: 120%; line-height: 130%; margin-bottom: 25px'>").append(g("<b>").html(g.usosCore.lang(z))))});o.append(g("<p>").text(g.usosCore.lang("Jeśli powyższy komunikat jest niezrozumiały, to zalecamy odświeżyć stronę. Być może w trakcie, gdy ją oglądałeś, utraciłeś uprawnienia do wykonania akcji, którą chciałeś wykonać.","If the notice displayed above is vague, then we advise you to refresh the page. Perhaps you have just lost permissions to perform the action you've been trying to perform.")));var s=g("<a class='ua-link'>").html(g.usosCore.lang("Odśwież stronę","Reload the page")).click(function(){window.location.reload(true)});var w=g("<a class='ua-link'>").html(g.usosCore.lang("Zamknij i kontynuuj","Close and continue")).click(function(){o.dialog("close")});o.append(g("<p style='text-align: center; font-size: 120%; margin-top: 20px'>").append(s).append(" ").append(g("<span class='ua-note'>").css({display:"inline-block",width:"60px"})).append(" ").append(w));if(e.settings.debug&&p.user_messages.fields){g.usosCore._console.warn("Displaying panic screen based on `user_messages.fields` response. Try to use `yourValueInputs.usosForms('showErrors', response)` if possible.")}}else{var v="";var u=false;if(typeof p==="object"&&p.xhr&&p.xhr.status>=400){n=0;v=" ("+p.xhr.status+")";if(p.xhr.status>=500&&p.xhr.status<600){u=true}}else{n=2000}o.append(g("<p style='font-size: 120%; margin-bottom: 25px'>").append(g("<b>").html(g.usosCore.lang({pl:"Wystąpił niespodziewany błąd"+v,en:"Unexpected error occured"+v}))));var r=g("<ul>");o.append(r);r.append(g("<li>").html(g.usosCore.lang("<p><b>Najpierw spróbuj odświeżyć stronę.</b> Odwieżenie strony często może pomóc, np. jeśli błąd jest spowodowany automatycznym wylogowaniem po dłuższej nieaktywności.</p><p style='font-size: 120%; margin-bottom: 18px'><a>Kliknij tutaj, aby odświeżyć stronę</a></p>","<p><b>First, try to refresh the page.</b> Refreshing can often help, particularly if the error occured due to an automatic user sign-out after a prolonged period of inactivity.</p><p style='font-size: 120%; margin-bottom: 18px'><a>Click here to refresh the page</a></p>")).each(function(){g(this).find("a").addClass("ua-link").click(function(){window.location.reload(true)})}));if(u){r.append(g("<li>").html(g.usosCore.lang("<p>Powiadomimy o tym błędzie administratorów i postaramy się go szybko naprawić. Czasem, tego rodzaju błędy mogą wynikać również z chwilowego przeciążenia serwerów, więc możesz spróbować wyświetlić stronę później.</p>","<p>We will notify the administrators about this error. Sometimes, these types of errors can also occur when the servers are overloaded - you may try to view this page later.")))}if(!u){r.append(g("<li>").html(g.usosCore.lang("Spróbuj ponownie wykonać akcję, która spowodowała wystąpienie błędu. Być może był to jednorazowy błąd spowodowany chwilową utratą połączenia z Internetem?","Try to repeat the action which you were doing when the error occured. Perhaps it was a one-time network error caused by bad Internet connection?")));r.append(g("<li>").html(g.usosCore.lang("Upewnij się, czy posiadasz odpowiednie uprawnienia. Czy jesteś zalogowany? Być może musisz uzyskać pewne dodatkowe uprawnienia, aby móc wyświetlić stronę lub wykonać akcję, którą właśnie próbowałeś wykonać?","Make sure you have proper privileges. Are you signed in? Perhaps, you need to acquire some special privileges before you can view this page or perform this action?")))}r.append(g("<li>").html(g.usosCore.lang("Jeśli problem będzie się powtarzał, to skontaktuj się z administratorem. Napisz na której stronie i w którym momencie problem występuje, tak aby administrator mógł go dokładniej zbadać.","If the problem persists, contact the administrator. Try to include detailed descriptions of where and when the error occurs, so that the administrator will be able to examine it closely.")));o.append(g("<p style='text-align: center; font-size: 120%; margin-top: 20px'>").html(g("<a class='ua-link'>").html(g.usosCore.lang("Zamknij i kontynuuj","Close and continue")).click(function(){o.dialog("close")})))}var t=function(){o.dialog({dialogClass:"ua-panic-dialog",resizable:false,modal:true,width:"600px",height:"auto",closeText:g.usosCore.lang("Zamknij","Close"),show:{effect:"fade",duration:150},hide:{effect:"fade",duration:150},close:function(){x.resolve()}})};setTimeout(t,n);if(e.settings.panicCallback){setTimeout(function(){e.settings.panicCallback(p)},100)}return x.promise()};var l=function(p,o,n){return function(){var s;var r=arguments;if((n=="getter")||((n=="auto")&&(arguments.length==0))){var q=undefined;this.each(function(){s=g(this).data(p);q=s[o].apply(s,r);return false});return q}return this.each(function(t){s=g(this).data(p);s[o].apply(s,r)})}};var h=function(n){e.preloaderElement.append(n)};var k=function(p){var o=g.extend({},{content:null,width:"auto",grey:false},p);var n=g.Deferred();var q=g("<a class='ua-close-link'><span class='ua-icon ua-icon-16 ua-icon-close'></span></a>");var r=g("<div>").css("position","relative").append(q).append(o.content);r.dialog({dialogClass:"ua-panic-dialog"+(o.grey?" ua-panic-dialog-grey":""),resizable:false,modal:true,width:o.width,height:"auto",open:function(s,t){g(".ui-widget-overlay").on("click",function(){g(this).siblings(".ui-dialog").find(".ui-dialog-content").dialog("close")})},closeText:g.usosCore.lang("Zamknij","Close"),close:function(){n.resolve()},show:{effect:"fade",duration:300},hide:{effect:"fade",duration:100}});q.on("click",function(){r.dialog("close")});return n.promise()};g[d]={_getSettings:function(){return e.settings},_console:j,_methodForwarder:l,_preload:h,_nlang:i,_simpleDialog:k,init:m,usosapiFetch:c,lang:b,panic:a}})(jQuery);(function(c){var b="usosBadge";var a={option:c.usosCore._methodForwarder("usosBadge","option","setter"),destroy:c.usosCore._methodForwarder("usosBadge","destroy","setter")};var d=function(e){var f=c.usosEntity._get(e.entity);if(!f.initBadge.call(this,e)){throw"Badge not implemented for this entity: "+e.entity}return this};c.fn[b]=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof e==="object")||(!e)){return d.apply(this,arguments)}else{c.error("Method "+e+" does not exist on jQuery."+b)}}}})(jQuery);(function(f){var e="usosEntity";var a={};var d=function(h){a[h.entityCode]=h};var b=function(h){if(a.hasOwnProperty(h)){return a[h]}else{throw"Unknown entityCode: "+h}};var c=function(l){var k=arguments;var i=b(l);var n={};var h=[];var m=function(o,p){n[o]=p;h.push(p)};f.each(i.primaryKeyFields,function(p,o){m(o,k[p+1])});var j=f.usosCore._getSettings().entityURLs[l];if(typeof j==="null"){}if(typeof j==="function"){j=j.apply(null,h);if(typeof j!=="string"){j=null}}else{if(typeof j==="string"){f.each(n,function(o,p){j=j.replace("${"+o+"}",p)})}}return j};var g=function(m,l){var n=l[0];var o=l[1];if((o===null)||(o===undefined)){return f("<span class='ua-note'>").text(f.usosCore.lang("(brak danych)","(no data)"))}var i=b(n);var k=i.getLabel(o);if(!m){return k}var h=f("<a>").attr("class","ua-link").html(k);var j=c(n,o.id);if(j){h.attr("href",j)}return h};f[e]={label:function(){return g.call(null,false,arguments)},link:function(){return g.call(null,true,arguments)},url:c,_register:d,_get:b}})(jQuery);(function(c){var b="usosForms";var a={hideErrors:c.usosCore._methodForwarder("usosValue","_hideErrors","setter"),showErrors:function(f){if((!f)||(!f.user_messages)){c.usosCore.panic(f);return false}var g=f.user_messages.fields;if(!g){c.usosCore.panic(f);return false}var e=c.extend({},f.user_messages.fields);this.each(function(){var h=c(this).data("usosValue")._showErrors(f);c.each(h,function(i,j){delete e[j]})});var d=0;c.each(e,function(){d++});if(d===0){return true}if(c.usosCore._getSettings().debug){c.usosCore._console.warn("showErrors: failed to match some fields. Will resolve to $.usosCore.panic. The following keys:",e,"were not found in",this)}this.usosForms("hideErrors");c.usosCore.panic(f);return false},flatValues:function(){var d={};this.each(function(){c.each(c(this).data("usosValue")._flatValues(),function(e,f){d[e]=f})});return d},values:function(){if(arguments.length==0){var d={};this.each(function(){var f=c(this).data("usosValue");d[f.options.name]=f.value()});return d}var e=arguments[0];this.each(function(){var f=c(this).data("usosValue");if(e[f.options.name]!==undefined){f.value(e[f.options.name])}});return this},findValueWidgets:function(){var d=this.find(".ua-usosvalue").addBack(".ua-usosvalue");var e=function(){return d.has(this).length>0};return d.not(e)}};c.fn[b]=function(d){if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{c.error("Method "+d+" does not exist on jQuery."+b)}}})(jQuery);(function(d){var c="usosUtils";var f=function(){var g=function(n,m){var l=n;d.each(m,function(o,p){l=l[p];if(typeof l==="undefined"){return l}});return l};var h=function(p,o,n){var m=p;var l=o.length-1;d.each(o,function(q,r){if(q==l){m[r]=n}else{if(typeof m[r]==="undefined"){m[r]={}}m=m[r]}})};var j=function(m,l){return m};var k=function(m,n){var l={};var t=[];var r="";var u=n+"$";for(var o=0;o<u.length;o++){var p=u.charAt(o);if(p=="["||p=="]"||p=="|"||p=="$"){t.push(r);var q=null;if(r!==""){q=g(m,t);if(typeof q==="undefined"){d.usosCore._console.error("Required field "+t.join(".")+" not found.")}}if(p=="["){}else{if(p=="|"||p=="$"){if(r!==""){h(l,t,q)}t.pop()}else{if(p=="]"){if(r!==""){h(l,t,q)}t.pop();t.pop()}}}r=""}else{r+=p}}return l};var i=null;return function(){if(!i){i=d.usosCore._getSettings().debug?k:j}return i.apply(null,arguments)}}();var b=function(i){var h=i.split(/[\r\n]{2,}/);var g=d("<div>");d.each(h,function(j,k){g.append(d("<p>").text(k))});return g.children()};var a=function(k){var g,j;if(jQuery.contains(document.documentElement,k[0])){g=k[0].scrollWidth;j=k[0].scrollHeight}else{var i=d("<div>").append(k).css({position:"absolute",visibility:"hidden"});d("body").prepend(i);g=i[0].scrollWidth;j=i[0].scrollHeight;i.detach()}return{width:g,height:j}};var e=function(k,m){var i;if(typeof m==="undefined"){m=true}if(k instanceof d){i=k}else{i=d.usosCore.lang({langdict:k,wrapper:"jQuery.html"})}i=d("<div>").append(i);if(m){var g=i.text().length;var j;if(g<300){j=300}else{if(g<1200){var l=1-((1200-g)/900);j=300+300*l}else{j=600}}i.css("max-width",j);var h=a(i).width;if(h>j){i.css("max-width",h)}}return i};d[c]={_tooltipster_html:e,requireFields:f,makeParagraphs:b}})(jQuery);(function(c){var b="usosValue";var a={value:c.usosCore._methodForwarder("usosValue","value","auto"),enable:c.usosCore._methodForwarder("usosValue","enable","setter"),disable:c.usosCore._methodForwarder("usosValue","disable","setter"),focus:c.usosCore._methodForwarder("usosValue","focus","setter")};c.fn[b]=function(d){if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{c.error("Method "+d+" does not exist on jQuery."+b)}}})(jQuery);(function(b){var a={};b.widget("usosWidgets._usosBadge",{options:{entity:null,position:"right"},_listenerAdded:false,_create:function(){var c=this;c.element.data("usosBadge",this);c._create2()},_create2:function(){var c=this;if(c._listenerAdded){return}c._on(c.element,{mouseenter:function(){c.timeoutId=setTimeout(function(){c._create3()},200)},mouseleave:function(){clearTimeout(c.timeoutId)}});c._listenerAdded=true},_create3:function(){var d=this;if(d.timeoutId){d._off(d.element,"mouseenter mouseleave");clearTimeout(d.timeoutId);d.timeoutId=null;var c=setTimeout(function(){d.element.tooltipster("show");d._off(d.element,"mouseout")},200);d._on(d.element,{mouseleave:function(){clearTimeout(c)}})}if(d.element.closest(".ua-tooltip").length>0){d.destroy();return}d.element.tooltipster({content:b.usosUtils._tooltipster_html("<p class='ua-loading'>"+b.usosCore.lang("Wczytywanie...","Loading...")+"</p>"),onlyOne:false,delay:400,updateAnimation:false,interactive:true,speed:0,position:d.options.position,theme:"ua-container ua-tooltip ua-tooltip-badge "+d._cssClass(),functionAfter:function(){d.element.tooltipster("destroy");d._listenerAdded=false;d._create2()}});d._updateBadgeContent()},_updateBadgeContent:function(){var c=this;c._fetchData().done(function(d){c.element.tooltipster("update",c._createBadge(d))}).fail(function(){c.element.tooltipster("update",b("<p class='ua-loading'>").text(b.usosCore.lang("Wystąpił błąd. Prosimy odświeżyć stronę.","Error occured. Please refresh the page.")))})},_fetchData:function(){var f=this;var d=b.Deferred();var e;if(!a.hasOwnProperty(f.options.entity)){a[f.options.entity]={}}e=a[f.options.entity];var c=f._getCacheKey();if(e[c]){d.resolve(e[c])}else{f._fetchData2().done(function(g){e[c]=g;d.resolve(g)}).fail(function(){d.reject()})}return d.promise()},_setOption:function(c,e){var d=this;d._super(c,e);d._create2()},_destroy:function(){var c=this;c.element.tooltipster("destroy")},_getCacheKey:function(){var d=this;var c=[];b.each(d._getEntityKey(),function(e,f){c.push(d.options[f])});return JSON.stringify(c)}})})(jQuery);(function(a){a.widget("usosWidgets._usosValue",{options:{name:null,value:null},_init:function(){this.element.addClass("ua-usosvalue");this.element.data("usosValue",this);this.element.attr("data-name",this.options.name)},_postInit:function(){if(this.options.disabled){this.disable()}},_destroy:function(){this._hideErrors();this.element.removeClass("ua-usosvalue")},_flattenValue:function(b){if(typeof b==="string"){return b}else{if(a.isArray(b)){return b.join("|")}else{if(b===null){return null}else{if(typeof b==="boolean"){return b?"true":"false"}}}}throw"Internal jQuery-USOS error. Invalid value for _flattenValue."},_flatValues:function(){var b={};var c=this.value();if(c!==null){b[this.options.name]=this._flattenValue(this.value())}return b},_showErrors:function(b){var c=b.user_messages.fields[this.options.name];if(c){this._displayError(c,this.options.name);return[this.options.name]}else{return[]}},_displayError:function(c,b){this.element.usosNotice({content:a.usosCore.lang(c)})},_hideErrors:function(){this.element.find(".ua-usosnotice").addBack(".ua-usosnotice").usosNotice("hide")},_focus:function(){var b=this.element.find("input, textarea, select, button").first();b.trigger("focus")},focus:function(){if(!this.options.disabled){this._focus()}},disable:function(){this._super("disable");this.element.find(".ui-button").button("option","disabled",true);this.element.find("input, textarea, select, button").prop("disabled",true)},enable:function(){this._super("enable");this.element.find(".ui-button").button("option","disabled",false);this.element.find("input, textarea, select, button").prop("disabled",false)},value:function(c){var b=this;if(typeof c==="undefined"){return b.option("value")}b.option("value",c);return this}})})(jQuery);(function(d){var a="_usosApiTable";function g(m,n){this._state=m;this._lastPublishedState=null;this.onStateChanged=n;this.publishState()}g.prototype.publishState=function(n){var m=this.getState();if((!n)&&(m==this._lastPublishedState)){return}this._lastPublishedState=m;this.onStateChanged(m)};g.prototype.getState=function(){return this._state};g.prototype.setState=function(m){this._state=m;this.publishState()};g.prototype.destroy=function(){};function b(o,m,p){this.paramName=o;this._lastPublishedState=null;this.onStateChanged=p;var n=this;d(window).bind("hashchange."+a,function(q){n.publishState()});if(this.getState()===null){this.setState(m)}else{this.publishState()}}b.prototype.publishState=function(n){var m=this.getState();if((!n)&&(m==this._lastPublishedState)){return}this._lastPublishedState=m;this.onStateChanged(m)};b.prototype.getState=function(){var m=d.bbq.getState(this.paramName);if(m){return m}return null};b.prototype.setState=function(n){var m={};m[this.paramName]=n;d.bbq.pushState(m)};b.prototype.destroy=function(){d(window).unbind("hashchange."+a)};var j=function(m){return(d.map(m,function(n){return(n.ascending?"":"-")+n.column})).join("|")};var l=function(m){return d.map(m.split("|"),function(n){return{column:n.replace("-",""),ascending:n[0]!="-"}})};var i=function(m){return d("<td>").addClass("ua-datatype-langdict").append(d.usosCore.lang({langdict:m,wrapper:"jQuery.text"}))};var e=function(m){var n=d("<td>").addClass("ua-datatype-boolean");if(m){n.addClass("ua-true").text(d.usosCore.lang("TAK","YES"))}else{n.addClass("ua-false").text(d.usosCore.lang("NIE","NO"))}return n};var f="1";var k=function(m){return(f+","+m.offset+","+j(m.orderRules).replace(/\|/g,","))};var h=function(m){try{var n=m.split(",");if(n[0]=="1"){return{offset:parseInt(n[1],10),orderRules:l(n.slice(2).join("|"))}}else{throw"Unknown serializer version"}}catch(o){d.usosCore._console.error("Could not deserialize apiTable state:",o);return{offset:0,orderRules:[]}}};var c=function(m,n){if(!n.field){return d("<td>").text("Missing 'field' key in column spec.")}var p;var o=m;d.each(n.field.split("."),function(q,r){o=o[r]});if(typeof o==="object"){p=i(o)}else{if(typeof o==="number"){p=d("<td>").addClass("ua-datatype-number").text(o)}else{if(typeof o==="string"){p=d("<td>").addClass("ua-datatype-string").text(o)}else{if(typeof o==="boolean"){p=e(o)}else{if(o===null){p=d("<td>").append(d("<span>").addClass("ua-note").text(d.usosCore.lang("(brak danych)","(no data)")))}else{if(o===undefined){p=d("<td>").text("Missing field '"+n.field+"' in data feed.")}else{p=d("<td>").text("Unknown column data type.")}}}}}}return p};d.widget("usosWidgets._usosApiTable",{options:{hashParam:null,source_id:"default",method:null,params:{},offsetReset:false,columns:null,defaultOrder:null,pageLength:6,methodLimit:null,actions:[],emptyMessage:{pl:"Brak wyników",en:"No results"},nowrap:true},widgetEventPrefix:"_usosapitable:",initialized:false,destroyed:false,currentOrder:null,stateCoordinator:null,syncObject:null,defaultAction:null,ediv:null,etable:null,esummary:null,_create:function(){var p=this;p.element.empty();var n=d("<div class='ua-container ua-table-container'>");var u=d("<table class='ua-table'>");if(p.options.nowrap){u.addClass("ua-ellipsis-tds")}n.append(u);p.element.append(n);var q=d("<thead>");var r=d("<tr>");q.append(r);d.each(p.options.columns,function(w,x){var y=d("<td>");if(x.width){y.css("width",x.width)}if(x.align){y.css("text-align",x.align)}if(x.sortable){y.addClass("ua-sortable");y.append(d("<a>").attr("tabindex",0).addClass("ua-sorter").attr("data-ua-fields",x.field).html(x.label))}else{y.addClass("ua-nonsortable");y.html(x.label)}if(x.cssClass){d.each(x.cssClass.split(" "),function(A,z){if(z){y.addClass(z)}})}r.append(y)});if(p.options.actions.length>0){r.append(d("<td>").addClass("ua-nonsortable").addClass("ua-actions").css("width",(1+p.options.actions.length*19)+"px"))}u.append(q);var o=d("<tbody class='ua-contents'>");u.append(o);var s=d("<tfoot>").append(d("<tr>").append(d("<td>").attr("colspan",p._columnCount()).append(d("<table>").css("width","100%").append(d("<tr>")))));s.find("table tr").append(d("<td>").css("vertical-align","middle").append(d("<div>").addClass("ua-summary"))).append(d("<td>").append(d("<ul>").addClass("ua-more").append(d("<div>").addClass("ua-prevpage").button({disabled:true,icons:{primary:"ui-icon-carat-1-w"},label:d.usosCore.lang("POPRZEDNIA STRONA","PREVIOUS PAGE")})).append(d("<div>").addClass("ua-nextpage").button({disabled:true,icons:{secondary:"ui-icon-carat-1-e"},label:d.usosCore.lang("NASTĘPNA STRONA","NEXT PAGE")}))));u.append(s);p.ediv=n;p.etable=n.find(".ua-table");p.esummary=n.find(".ua-summary");p.esorters=n.find(".ua-sorter");p.econtents=n.find(".ua-contents");p.eprevPage=n.find(".ua-prevpage");p.enextPage=n.find(".ua-nextpage");p.esorters.each(function(){var y=d(this);var x=d("<div>").css("margin-left","3px").hide();y.after(x);var w=d("<span class='ua-loading'>").hide();x.after(w);y.data(a,{img:x,loader:w,orderRules:l(y.attr("data-ua-fields"))});if(y.parent().hasClass("ua-sortable")){p._on(y.parent(),{click:function(){y.trigger("click")}})}});p._on(p.esorters,{click:function(B){if(!p.initialized){return}var E=d(B.currentTarget).data(a);p.etable.find("thead .ua-loading").hide();E.loader.show();var D=d.map(E.orderRules,function(H,G){return H.column});p.currentOffset=0;var x=true;if(p.currentOrder.length>0&&p.currentOrder[0].column==D[0]&&p.currentOrder[0].ascending===true){x=false}var F=[];var w=[];var z;for(z=0;z<p.currentOrder.length;z++){if(d.inArray(p.currentOrder[z].column,D)!==-1){F[p.currentOrder[z].column]=p.currentOrder[z]}else{w.push(p.currentOrder[z])}}var y=[];for(z=0;z<D.length;z++){var C=null;if(F[D[z]]){C=F[D[z]];C.ascending=x}else{C={column:D[z],ascending:x}}y.push(C)}var A=y;for(z=0;z<w.length;z++){A.push(w[z])}p.stateCoordinator.setState(k({orderRules:A,offset:0}));return false},keypress:function(w){if(w.which==13){d(w.currentTarget).trigger("click")}}});p._on(p.eprevPage,{click:function(w){d(w.currentTarget).button("disable");p.stateCoordinator.setState(k({offset:p.currentOffset-p.options.pageLength,orderRules:p.currentOrder}))}});p._on(p.enextPage,{click:function(w){d(w.currentTarget).button("disable");p.stateCoordinator.setState(k({offset:p.currentOffset+p.options.pageLength,orderRules:p.currentOrder}))}});p.syncObject={};p.defaultAction=null;d.each(p.options.actions,function(w,x){if(x.isDefault){if(p.defaultAction){d.usosCore._console.error("More than one default action defined.");return false}p.defaultAction=x}});p.currentOrder=null;p.currentOffset=0;var v=k({offset:0,orderRules:l(p.options.defaultOrder)});var t=function(w){p.initialized=true;var x=h(w);p.currentOrder=x.orderRules;p.currentOffset=x.offset;p.reload()};if(p.options.hashParam){p.stateCoordinator=new b(p.options.hashParam,v,t)}else{p.stateCoordinator=new g(v,t)}if(p.options.offsetReset){var m=h(p.stateCoordinator.getState());m.offset=0;p.stateCoordinator.setState(k(m))}return n},reload:function(){var m=this;d.usosCore._console.log("Reloading with order "+j(m.currentOrder)+"...");m._refreshSorterImages();m._overlayContentWith(d("<span>").addClass("ua-loading"));m._updateSummary(d("<span>").addClass("ua-loading").text(d.usosCore.lang("Wczytywanie...","Loading...")));d.usosCore.usosapiFetch({source_id:m.options.source_id,method:m.options.method,params:m._constructMethodParameters(),syncMode:"receiveLast",syncObject:m.syncObject,success:function(r){if(m.destroyed){return}m.econtents.empty();d.each(r.items,function(t,s){var u=d("<a class='ua-tr'>");u.data(a,s);d.each(m.options.columns,function(w,x){var y;if(x.customTdFormatter){y=x.customTdFormatter(s)}else{y=c(s,x)}if(x.cssClass){d.each(x.cssClass.split(" "),function(A,z){if(z){y.addClass(z)}})}if(x.align){y.css("text-align",x.align)}if(m.options.nowrap){m._on(y,{mouseenter:function(B){var A=d(B.currentTarget);if(A.attr("title")){return}var z=false;var B=A.clone().css({display:"inline",width:"auto",visibility:"hidden"}).appendTo("body");z=B.width()>A.width();B.remove();if(z){A.attr("title",A.text())}}})}u.append(y)});if(m.options.actions.length>0){var v=d("<td class='ua-actions'>");d.each(m.options.actions,function(w,x){var y=d("<a class='ua-action-icon'>").attr("tabindex",0).append(d("<div>").addClass("ui-icon").addClass(x.iconClass)).usosTip({type:"tool",content:x.label,position:"top",delayed:true}).keypress(function(z){if(z.which==13){d(this).trigger("click")}});if(x.click){y.on("click",function(){x.click(s);return false})}if(x.hrefProvider){y.attr("href",x.hrefProvider(s))}if((x.isVisible)&&(!x.isVisible(s))){y.css("visibility","hidden")}v.append(y)});u.append(v)}m.econtents.append(u)});if(m.defaultAction){var n=m.econtents.find("a.ua-tr");m._on(n,{mouseenter:function(s){d(s.currentTarget).addClass("ua-hovered")},mouseleave:function(s){d(s.currentTarget).removeClass("ua-hovered")}});if(m.defaultAction.click){m._on(n,{click:function(s){m.defaultAction.click(d(s.currentTarget).data(a))}})}if(m.defaultAction.hrefProvider){n.each(function(){d(this).attr("href",m.defaultAction.hrefProvider(d(this).data(a)))})}}m.enextPage.button(r.next_page?"enable":"disable");m.eprevPage.button(m.currentOffset>0?"enable":"disable");m.etable.colResizable({liveDrag:true,headerOnly:true});m.etable.find("thead .ua-loading").hide();m._removeOverlay();if(m.currentOffset+r.items.length===0){var o=d("<span>").html(d.usosCore.lang(m.options.emptyMessage));m._overlayContentWith(o);m._updateSummary("")}else{if(m.options.methodLimit&&m.currentOffset+m.options.pageLength>=m.options.methodLimit){var q=d("<div>").html(d.usosCore.lang("<b style='color: #c00'>Uwaga:</b> Wyświetlanych jest "+m.options.methodLimit+" pierwszych wyników wyszukiwania","<b style='color: #c00'>Please note:</b> Only the first "+m.options.methodLimit+" search results are displayed"));q.append(" ").append(d.usosWidgets.usosTip.create("<p>Nawet jeśli więcej wyników pasuje do Twojego zapytania, z pomocą tej wyszukiwarki możesz ich wyświetlić co najwyżej <b>"+m.options.methodLimit+"</b>.</p><p>Jeśli nie możesz znaleźć szukanego elementu na liście, to spróbuj zmodyfikować parametry swojego wyszukiwania (np. użyć filtrów lub inaczej posortować listę wyników).</p>","<p>Even if more results match your query, this page allows you to see at most <b>"+m.options.methodLimit+"</b> of them.</p><p>If you cannot find your element on this list, then try to modify your search parameters (e.g. use the filters or try to sort the results differently).</p>"));m._updateSummary(q)}else{var p=(d.usosCore.lang("Pokazywane elementy ","Showing items ")+(m.currentOffset+1)+".."+(m.currentOffset+r.items.length));if(r.total){p+=d.usosCore.lang(" (spośród "," (out of ");p+=r.total+")"}m._updateSummary(p)}}},error:function(){var n=d("<span>").html(d.usosCore.lang("Wystąpił błąd podczas wczytywania. Spróbuj odświeżyć stronę (F5).","There was an error while loading. Try to refresh the page (F5)."));m._overlayContentWith(n);m._updateSummary(n.clone(true));m.etable.find("thead .ua-loading").hide()}})},_columnCount:function(){var n=this;var m=n.options.columns.length;if(n.options.actions.length>0){m++}return m},_init:function(){var m=this;m._super("_init")},_setOptions:function(m){var n=this;n._super(m);n._create();return this},_updateSummary:function(n){var m=this;if(typeof n==="string"){n=d("<span>").text(n)}m.esummary.empty().append(n)},_removeOverlay:function(){var m=this;m.ediv.find(".ua-overlay-background").remove();m.ediv.find(".ua-overlay-foreground").remove()},_overlayContentWith:function(p){var o=this;if(!o.econtents.is(":parent")){o.econtents.html("<tr class='ua-placeholder'><td></td></tr>").find("td").attr("colspan",o._columnCount())}var n=o.ediv.find(".ua-overlay-background");if(n.length===0){n=d("<div class='ua-overlay-background'>").hide();o.ediv.append(n)}var m=o.ediv.find(".ua-overlay-foreground");if(m.length===0){m=d("<table class='ua-overlay-foreground'>").hide().append(d("<tr>").append(d("<td>")));o.ediv.append(m)}m.find("td").empty().append(p.clone());n.css("left",o.econtents.position().left+1).css("top",o.econtents.position().top+1).css("width",o.econtents.width()-1).css("height",o.econtents.height()-1).fadeIn("slow");m.delay(200).each(function(){if(!d.contains(document.documentElement,n[0])){return}m.css(o.econtents.position()).css("width",o.econtents.width()).css("height",o.econtents.height()).fadeIn(500)})},_constructMethodParameters:function(){var m=this;return d.extend({},m.options.params,{order_by:j(m.currentOrder),start:m.currentOffset,num:m.options.pageLength})},_refreshSorterImages:function(){var m=this;var n;if(m.currentOrder.length>0){n=m.currentOrder[0]}else{n={column:"",ascending:true}}m.esorters.each(function(){var o=d(this).data(a);if(o.orderRules[0].column==n.column){o.img.attr("class",n.ascending?"ua-ascending":"ua-descending");d(this).closest("td").addClass("ua-sorted-by")}else{o.img.removeClass("ua-ascending ua-descending");d(this).closest("td").removeClass("ua-sorted-by")}})},_destroy:function(){var m=this;m.destroyed=true;m.stateCoordinator.destroy();m.element.empty();m._super("_destroy")}})})(jQuery);(function(d){var b={type:"tool",position:"right",content:{pl:"Zgłoś niepoprawne dane",en:"Report invalid data"},delayed:true};var a=function(){var e=d.Deferred();var f=false;var g="ua-feedback-enabled";return function(){if(typeof(Storage)=="undefined"){return false}if(typeof(sessionStorage[g])==="undefined"){if(f){return e.promise()}f=true;d.usosCore.usosapiFetch({method:"services/feedback/status"}).done(function(h){sessionStorage[g]=h.enabled?"1":"0"}).fail(function(){sessionStorage[g]="0"}).always(function(){e.resolve(sessionStorage[g]=="1")})}else{e.resolve(sessionStorage[g]=="1")}return e.promise()}}();d.widget("usosWidgets._usosFeedback",{options:{form:[{pl:"Co jest nie tak? Czy pole ma niepoprawną lub nieaktualną wartość?",en:"What is wrong? Is the value of the field invalid, or outdated?"}],meta:null,tip:true,tipOptions:{}},widgetEventPrefix:"usosfeedback:",defaultElement:"<span>",dialogTitle:null,dialogDiv:null,_create:function(){var f=this;var e=d.extend({},b,f.tipOptions);if(f.options.tip){f.element.usosTip(e)}f.dialogTitle=e.content;f._on({click:function(){f.open()}})},open:function(){var e=this;var f=d("<div>");e.dialogDiv=f;f.append(d("<div class='ua-h1'>").text(d.usosCore.lang(e.dialogTitle)));d.each(e.options.form,function(g,h){f.append(d("<div class='ua-input-with-header'>").append(d("<div class='ua-h'>").html(d.usosCore.lang(h))).append(d("<div>").usosTextbox({multiline:true})))});f.append(d("<div class='ua-footnote'><table><tr><td class='ua-1'></td><td class='ua-2'></td></tr></table></div>"));f.find(".ua-1").append("<span class='ua-icon ua-icon-32 ua-icon-checkmark-circle'>");f.find(".ua-2").append(d("<span>").html(d.usosCore.lang("Postaramy się przekazać zgłoszenie odpowiedniej osobie. Nie możemy jednak obiecać, że dane zostaną poprawione. Zgłoszenia od osób zalogowanych otrzymują wyższy priorytet niż zgłoszenia anonimowe.","We will try to forward your report to the appropriate person. However, we cannot guarantee that the data will be amended. Reports from signed-in users are given higher priority than anonymous reports.")));f.dialog({title:d.usosCore.lang(e.dialogTitle),dialogClass:"ua-feedback-dialog",resizable:false,modal:true,width:480,height:"auto",closeText:d.usosCore.lang("Anuluj","Cancel"),buttons:[{id:"ua-bsave",text:d.usosCore.lang("Wyślij zgłoszenie","Send feedback"),click:function(){e._saveClicked()},icons:{primary:"ui-icon-check"}},{text:d.usosCore.lang("Anuluj","Cancel"),click:function(){d(this).dialog("close")}}],show:{effect:"fade",duration:200},hide:{effect:"fade",duration:200},close:function(){e.element.trigger("blur");f.dialog("destroy")}})},_saveClicked:function(){var f=this;var e=f.dialogDiv;d("#ua-bsave").button("disable");e.usosForms("findValueWidgets").usosValue("disable");var h=d("<span class='ua-loading'>").text("Wysyłanie...","Sending...").hide();e.closest(".ui-dialog").find(".ui-dialog-buttonset").prepend(h);h.delay(200).fadeIn(200);var g=[];e.find(".ua-input-with-header").each(function(){g.push({title:d(this).find("div:first-child").text(),value:d(this).find("div:last-child").usosValue("value")})});d.usosCore.usosapiFetch({method:"services/feedback/report_db",params:{user_form:JSON.stringify(g),meta:JSON.stringify(d.extend({},f.options.meta,{"jquery-usos":{url:document.location.href,lang:d.usosCore.lang()}}))}}).done(function(){f.dialogDiv.dialog("close");f.element._usosFeedback("destroy");if(f.element.hasClass("ua-icon-warning")){f.element.removeClass("ua-icon-warning").addClass("ua-icon-checkmark-circle").addClass("ua-feedback-complete").usosTip(d.extend({},b,f.options.tipOptions,{delayed:false,content:d.usosCore.lang("Dziękujemy!","Thank you!")})).hide().fadeIn(500)}}).fail(function(i){d.usosCore.panic(i).done(function(){d("#ua-bsave").button("enable");e.usosForms("findValueWidgets").usosValue("enable");h.remove()})})},_destroy:function(){var e=this;e.element.usosTip("destroy")}});var c=function(e){var f=d("<span class='ua-feedback-icon ua-icon ua-icon-16 ua-icon-warning'>").hide();a().done(function(g){if(g){f.show();f._usosFeedback(e)}});return f};d.usosWidgets._usosFeedback.create=c})(jQuery);(function(a){a.widget("usosWidgets.usosCheckbox",a.usosWidgets._usosValue,{options:{value:false,caption:""},widgetEventPrefix:"usoscheckbox:",_init:function(){var b=this;b._super("_init");b._build();b._postInit()},_build:function(){var d=this;d.element.empty();var c;if(d.options.caption instanceof a){c=d.options.caption}else{c=a("<span>").html(a.usosCore.lang(d.options.caption))}d.element.append(a("<label>").append(a("<table class='ua-checkbox-or-radio'>").append(a("<tr>").append(a("<td>").append(a("<input type='checkbox'>"))).append(a("<td>").append(c)))));var b=d.element.find("input");if(d.options.value){b.prop("checked",true)}b.on("change",function(f){d.options.value=b.prop("checked");d._trigger("change",f)})},_setOption:function(b,c){this._super(b,c);if(a.inArray(b,["caption"])!==-1){this._build()}else{if(b=="value"){this.element.find("input").prop("checked",c?true:false)}}return this},_destroy:function(){this.element.empty();this._super("_destroy")}})})(jQuery);(function(c){var a=false;var b=function(f){var h=c(window).scrollTop();var g=h+c(window).height();var d=c(f).offset().top;var e=d+c(f).height();return((e<=g)&&(d>=h))};c.widget("usosWidgets.usosNotice",{options:{content:"",scroll:true},widgetEventPrefix:"usosnotice:",_create:function(){var e=this;e.element.addClass("ua-usosnotice");e.element.tooltipster({trigger:"custom",interactive:true,content:c.usosUtils._tooltipster_html(e.options.content),onlyOne:false,position:"right",theme:"ua-container ua-tooltip ua-tooltip-error",functionReady:function(){e._tooltipReady()},functionAfter:function(){e.destroy()}});var d=function(){e.hide()};e._on(e.element.find(":focusable").addBack(":focusable"),{focus:d,keypress:d,change:d})},_init:function(){var d=this;d.element.tooltipster("show");d._scroll()},_scroll:function(){var e=this;var d=e.element.data("tooltipster");if(d&&e.options.scroll&&(!b(d))&&(!a)){a=true;c("html, body").animate({scrollTop:e.element.data("tooltipster").offset().top-30},500,function(){a=false})}},_tooltipReady:function(){var e=this;var d=e.element.data("tooltipster");d.css("pointer-events","");d.find(".tooltipster-content").css("pointer-events","auto");e._scroll();e._on(d.find(".tooltipster-content"),{click:function(){e._trigger(e.element.find(":focusable").addBack(":focusable").first(),"focus");e.hide()},mouseleave:function(){return false}})},hide:function(){this.element.tooltipster("hide")},_setOption:function(d,f){var e=this;e._super(d,f);if(d=="content"){e.element.tooltipster("update",c.usosUtils._tooltipster_html(e.options.content))}return e},_destroy:function(){this.element.tooltipster("destroy");this.element.removeClass("ua-usosnotice")}})})(jQuery);(function(b){var a=function(d){var c=0;d.parents().each(function(){var e=parseInt(b(this).css("zIndex"),10);if(e>c){c=e}});return c};b.widget("usosWidgets.usosProgressOverlay",{options:{type:"loading",delay:300,opacity:0.8,fadeDuration:300},widgetEventPrefix:"usosprogressoverlay:",_create:function(){var c=this;c.bg=b("<div>").addClass("ua-progressoverlay-background").css("opacity",0.01);b(document.body).append(c.bg);c.fg=b("<table>").addClass("ua-progressoverlay-foreground").css("opacity",0.01).append(b("<tr>").append(b("<td>")));b(document.body).append(c.fg);c.fg.find("td").empty();c.bg.add(c.fg).css("z-index",a(c.element)+1).css("left",c.element.offset().left).css("top",c.element.offset().top).css("width",c.element.outerWidth()).css("height",c.element.outerHeight()).css("opacity",0.01).delay(c.options.delay).each(function(){if(b("body").has(c.bg).length>0){b(this).animate({opacity:c.options.opacity},c.options.fadeDuration)}});var d;switch(c.options.type){case"loading":d=b.usosCore.lang("Wczytywanie...","Loading...");break;case"saving":d=b.usosCore.lang("Zapisywanie...","Saving...");break;default:throw ("Unknown type: "+c.options.type)}c.fg.find("td").append(b("<span>").attr("class","ua-loading").attr("title",d));c.fg.delay(c.options.delay+(c.options.fadeDuration/2)).each(function(){if(c.bg&&c.fg){c.fg.fadeIn(c.options.fadeDuration)}})},_destroy:function(){var c=this;if(c.bg){c.bg.stop(true).remove();delete c.bg}if(c.fg){c.fg.stop(true).remove();delete c.fg}}})})(jQuery);(function(b){var a=1;b.widget("usosWidgets.usosRadioboxes",b.usosWidgets._usosValue,{options:{width:"500px",value:"",options:[]},widgetEventPrefix:"usosradioboxes:",_create:function(){var c=this;c.uniqueName="ua-radio-uid-"+a++},_init:function(){var c=this;c._super("_init");c._build();c._postInit()},_createOption:function(g,h,e){var f=this;var d=b("<label>").append(b("<table class='ua-checkbox-or-radio'>").append(b("<tr>").append(b("<td>").append(b("<input type='radio'>"))).append(b("<td>").append(b.usosCore.lang(h)))));var c=d.find("input");c.attr("name",f.uniqueName);if(typeof g==="string"){c.attr("value",g)}else{c.attr("value","(complex)");c.data("value",g)}if(e){c.prop("checked",true)}return d},_getInputValue:function(c){if(b(c).data("value")!==undefined){return b(c).data("value")}else{return b(c).attr("value")}},_getRadiogroupValue:function(){var c=this.element.find("input:checked");if(c.length>0){return this._getInputValue(c)}else{return null}},_build:function(){var c=this;c.element.empty().append(b("<div class='ua-radiogroup'>").css("width",c.options.width));var d=c.value();var e=c.element.find("div.ua-radiogroup");b.each(c.options.options,function(f,g){e.append(c._createOption(g.value,g.caption,d===g.value))});e.find("input").on("change",function(f){c.options.value=c._getRadiogroupValue();c._trigger("change",f)})},_setOption:function(c,e){this._super(c,e);var d=this;if(b.inArray(c,["width","options"])!==-1){d._build()}else{if(c=="value"){b.each(d.element.find("input"),function(f,g){if(d._getInputValue(g)===e){g.prop("checked",true);return false}})}}return this},_destroy:function(){this.element.empty();this._super("_destroy")}})})(jQuery);(function(a){a.widget("usosWidgets.usosSelectbox",a.usosWidgets._usosValue,{options:{width:"300px",value:"",options:[]},widgetEventPrefix:"usosselectbox:",_init:function(){var b=this;b._super("_init");b._build();b._postInit()},_createOption:function(d,e,c){var b=a("<option>").text(a.usosCore.lang(e));if(typeof d==="string"){b.attr("value",d)}else{b.attr("value","(complex)");b.data("value",d)}if(c){b.prop("selected",true)}b.addClass((d===null)?"ua-null-value":"ua-nonnull-value");return b},_getOptionValue:function(b){if(a(b).data("value")!==undefined){return a(b).data("value")}else{return a(b).attr("value")}},_getSelectValue:function(){var b=this.element.find("select option:selected");if(b.length>0){return this._getOptionValue(b)}else{return null}},_refreshClass:function(){var c=this;var b=c.element.find("select");if(c.options.value===null){b.addClass("ua-null-selected")}else{b.removeClass("ua-null-selected")}},_build:function(){var c=this;c.element.empty().append(a("<select class='ua-form'>").css("width",c.options.width));var d=c.value();var b=c.element.find("select");a.each(c.options.options,function(e,f){b.append(c._createOption(f.value,f.caption,d===f.value))});c._refreshClass();b.on("change",function(f){c.options.value=c._getSelectValue();c._refreshClass();c._trigger("change",f)})},_setOption:function(b,d){this._super(b,d);var c=this;if(a.inArray(b,["width","options"])!==-1){c._build()}else{if(b=="value"){c.element.find("select").val(d);if(c._getSelectValue()!==d){a.each(c.element.find("select option"),function(e,f){if(c._getOptionValue(f)===d){f.prop("selected",true);return false}})}}}return this},_destroy:function(){this.element.empty();this._super("_destroy")}})})(jQuery);(function(g){var e=function(i){var h=g.usosEntity._get(i);if(h.getSelectorSetup){return h.getSelectorSetup()}throw"This entity doesn't implement selectors yet: "+i};var f=function(i,h){return JSON.stringify(i)==JSON.stringify(h)};var c=function(h){if(h){return 0.25}else{return 0.05}};var d=null;var b=function(h,i){a();d=setTimeout(function(){d=null;i()},h*1000)};var a=function(){if(d){clearTimeout(d);d=null}};g.widget("usosWidgets.usosSelector",g.usosWidgets._usosValue,{options:{entity:null,source_id:"default",width:"300px",multi:false,value:null,placeholder:null,searchParams:{}},widgetEventPrefix:"usosselector:",_lastQuery:"",_init:function(){this._super("_init");this._recreate();this._postInit()},_width:function(){var h=this;return Math.max(parseInt(h.options.width,10),80)},_setOption:function(h,i){this._super(h,i);if(g.inArray(h,["entity","width","multi"])!==-1){this._recreate()}else{if(h=="value"){this.value(h,i)}}return this},_recreate:function(){var l=this;l._uid=Math.random().toString(36).substring(2,10);l._entitySetup=e(l.options.entity);l._knownItems={};l._progressIndicator=g("<span class='ua-progress'>").hide();l.element.empty().addClass("ua-container ua-selector").css("width",l._width()+"px").append(l._progressIndicator).append(g("<textarea>").attr("rows","1").css("width",l._width()+"px"));l._suggestionsSyncObject={};l._previousValue=l.options.multi?[]:null;l._textarea=l.element.find("textarea");var h=((l.options.placeholder!==null)?g.usosCore.lang(l.options.placeholder):l._entitySetup.prompt);if(h){var i=g('<label class="ua-screen-reader-only">').attr("for",l._uid);i.text(h+g.usosCore.lang(" - Wpisz tekst i wciśnij enter aby wyszukać"," - Type text and press enter to search"));l._textarea.before(i)}l._textarea.attr("id",l._uid);var j=l.element.offset().top;var k=g(document).height()-(l.element.offset().top+l.element.height());l._textarea.textext({plugins:"autocomplete tags focus prompt",prompt:h,html:{dropdown:('<div class="text-dropdown" style="min-width: 300px"><div class="text-list" tabindex="-1"></div>')},autocomplete:{dropdown:{maxHeight:"250px",position:(k>200)?"below":((j>k)?"above":"below")},render:function(m){var n=g("<span>");if(m=="empty"){n.addClass("ua-empty").html(g.usosCore.lang("Brak wyników","No results"))}else{if(m=="more"){n.addClass("ua-more").html(g.usosCore.lang("Pokaż więcej wyników","See more results"))}else{if(m=="more-hidden"){n.addClass("ua-more ua-more-hidden").html(g.usosCore.lang("Pokaż wyniki","See results"))}else{n.html(l._entitySetup.suggestionRenderer(l._knownItems[m]))}}}n.find("*").addBack().addClass("text-label");return n}},ext:{tags:{renderTag:function(m){var o=g(this.opts("html.tag"));var n=l._entitySetup.tagRenderer(l._knownItems[m]);n.css({"white-space":"nowrap",display:"inline-block",overflow:"hidden","text-overflow":"ellipsis","max-width":(l._width()-40)+"px"});o.find(".text-label").html(n);o.data(l.widgetFullName,l._knownItems[m]);o.data("text-tag",m);return o}}}}).bind("getSuggestions",function(p,o){var q=g(this);var m=g(p.target).textext()[0];var n=(o?o.query:"")||"";l._lastQuery=n;b(c(n),function(){l._progressIndicator.delay(300).fadeIn(300);g.usosCore.usosapiFetch({source_id:l.options.source_id,method:l._entitySetup.search.method,params:g.extend({},l.options.searchParams,l._entitySetup.search.paramsProvider(n)),syncMode:"receiveIncrementalFast",syncObject:l._suggestionsSyncObject,success:function(s){var r=[];g.each(l._entitySetup.search.itemsExtractor(s),function(t,u){var v=l._entitySetup.idExtractor(u);l._knownItems[v]=u;r.push(v)});if(r.length>3){r.push("more")}else{if(r.length==0){r.push("empty")}else{if(r.length>0){r.push("more-hidden")}}}q.trigger("setSuggestions",{result:r});l._checkProgress()},error:function(t,s,r){l._textarea.usosNotice({content:g.usosCore.lang("Nie udało się wczytać listy sugestii. Spróbuj odświeżyć stronę (F5).","Could not load the list of suggestions. Try to refresh tha page (F5).")});l._checkProgress()}})})}).bind("isTagAllowed",function(o,n){if(n.tag=="empty"){n.result=false;l._popout();return}if(n.tag=="more"||n.tag=="more-hidden"){l._popout();n.result=false;return}if(!l._knownItems[n.tag]){l._textarea.usosNotice({content:g.usosCore.lang("Przed wciśnięciem Enter należy poczekać na załadowanie listy sugestii.","Before pressing Enter, you should wait until the suggestions show up.")});n.result=false;return}var m=l._getIds();if((!l.options.multi)&&(m.length>0)){l._setIds([]);return}if(l.options.multi&&g.inArray(n.tag,m)!==-1){l._textarea.usosNotice({content:g.usosCore.lang("Ta pozycja już znajduje się na liście.","This item is already on the list.")});n.result=false;return}}).bind("setFormData",function(){var n=l.element.usosSelector("value");l.options.value=n;if(!l.options.multi){if(n===null){l._markUnfilled()}else{l._markFilled()}}if(!f(n,l._previousValue)){var o=l._previousValue;var p=n;l._previousValue=n;l._trigger("change");if(!l._textarea.prop("disabled")){if(p!=null&&l._entitySetup.affector&&(g.usosCore._getSettings().usosAPIs["default"].user_id!==null)){if(!g.isArray(p)){p=[p]}if(!g.isArray(o)){o=[o]}var m=g(p).not(o).get();if(m.length>0){l._entitySetup.affector(m)}}}}});if(l.options.value){l.element.usosSelector("value",l.options.value)}},_markFilled:function(){this.element.addClass("ua-filled")},_markUnfilled:function(){this.element.removeClass("ua-filled")},_getIds:function(){var h=[];var i=this;g.each(i._textarea.textext()[0].tags().tagElements(),function(j,k){h.push(i._entitySetup.idExtractor(g(k).data(i.widgetFullName)))});return h},_checkProgress:function(){var h=this;var i=h._suggestionsSyncObject;if(i.lastIssuedRequestId==i.lastReceivedRequestId){h._progressIndicator.stop(true,false).hide()}},_setIds:function(i){var k=this;var l=k._textarea.prop("disabled");k._textarea.prop("disabled",true);var h=function(){g.each(k._getIds(),function(n,o){k._textarea.textext()[0].tags().removeTag(o)});var m=i.filter(function(n){return typeof k._knownItems[n]!=="undefined"});k._textarea.textext()[0].tags().addTags(m);k._textarea.prop("disabled",l);if(m.length<i.length){k._textarea.usosNotice({content:g.usosCore.lang("Wystąpił błąd podczas wczytywania wartości tego pola. Sprawdź, czy pole zawiera pożądaną wartość. Jeśli problem będzie się powtarzał, proszę skontaktować się z administratorem.","Error occured while loading values for this form field. Check if the field has the proper value. If this problem persists, please contact the administrator.")})}};var j=i.filter(function(m){return typeof k._knownItems[m]==="undefined"});if(j.length>0){k.element.usosProgressOverlay();g.usosCore.usosapiFetch({source_id:k.options.source_id,method:k._entitySetup.get.method,params:k._entitySetup.get.paramsProvider(j),success:function(m){k.element.usosProgressOverlay("destroy");g.each(k._entitySetup.get.itemsExtractor(m),function(n,o){var p=k._entitySetup.idExtractor(o);k._knownItems[p]=o});h()},error:function(o,n,m){k._textarea.usosNotice({content:g.usosCore.lang("Wystąpił błąd podczas wczytywania wartości tego pola. Spróbuj odświeżyć stronę (F5).","Error occured while loading values for this form field. Try to refresh the page (F5).")})}})}else{h()}},value:function(i){if(typeof i==="undefined"){var h=this._getIds();if(this.options.multi){return h}else{if(h.length===0){return null}else{return h[0]}}}if(this.options.multi){this._setIds(i)}else{if(i===null){this._setIds([])}else{this._setIds([i])}}return this},_destroy:function(){this.element.empty();this._super("_destroy")},_popout:function(){var i=this;var h=g("body > *");h.attr("aria-hidden","true");var j=g("<div>");g("body").addClass("ua-stop-scrolling");j.dialog({dialogClass:"ua-panic-dialog ua-scrollable ua-selector-popup",resizable:false,modal:true,width:Math.min(Math.max(300,i._width())*2.2+30,g(window).width()*0.8),minHeight:200,height:Math.min(g(window).height()*0.7,600),closeText:g.usosCore.lang("Zamknij","Close"),close:function(){g("body").removeClass("ua-stop-scrolling");h.removeAttr("aria-hidden");i._textarea.focus();try{j.usosProgressOverlay("destroy")}catch(k){}}});j.usosProgressOverlay();g.usosCore.usosapiFetch({source_id:i.options.source_id,method:i._entitySetup.search.method,params:g.extend({},i.options.searchParams,i._entitySetup.search.paramsProvider(i._lastQuery),{num:20})}).always(function(){try{j.usosProgressOverlay("destroy")}catch(k){}}).done(function(l){j.append(g.usosCore.lang("<p class='ua-howto' tabindex='0'><span class='if-query'>Wyniki dla zapytania <span class='query'></span>.<br></span>Kliknij element, aby go wybrać. Wciśnij klawisz Esc, aby zamknąć to okno. <span class='ua-screen-reader-only'>Na liście wyników możesz poruszać się tabulatorem oraz strzałkami góra/dół.</span></p>","<p class='ua-howto tabindex='0'><span class='if-query'>Search results for <span class='query'></span>.<br></span>Click to choose element. Press Esc, to cancel.</p>"));j.prepend('<span class="ua-close-button" aria-hidden="true"></span>');j.find(".ua-close-button").bind("click",function(n){n.preventDefault();j.dialog("close")});j.find(".ua-howto").bind("keypress keydown",function(n){if(n.keyCode==40||n.which==40){g(".ua-inline-suggestion").first().focus()}}).focus();var m=g("<ul style='display: inline-block; text-align: center; padding: 0;'>");j.append(m);var k=i._entitySetup.search.itemsExtractor(l);g.each(k,function(n,p){var q=i._entitySetup.idExtractor(p);var o=g("<li class='ua-inline-suggestion'> ").css("width",Math.max(300,i._width())-4).html(i._entitySetup.suggestionRenderer(p)).attr("tabindex",0).attr("id","ua-suggestion-id-"+n).on("focus",function(){g(this).addClass("text-selected")}).on("blur",function(){g(this).removeClass("text-selected")}).hover(function(){g(this).addClass("text-selected")},function(){if(!(g(this).is(":focus"))){g(this).removeClass("text-selected")}}).on("click keypress keydown",function(t){var s=t.keyCode||t.which;if((t.type=="keypress"||t.type=="keydown")&&t.which!=13&&t.which!=9&&t.which!=27&&t.which!=32&&t.which!=38&&t.which!=40){return}switch(s){case 9:return true;case 27:j.dialog("close");return true;case 39:return true;case 38:if(g(this).attr("id")=="ua-suggestion-id-0"){g(".ua-howto").focus()}else{g(this).prev().focus()}t.preventDefault();return true;case 40:if(g(this).attr("id")=="ua-suggestion-id-19"){g(".ua-warning").focus()}else{g(this).next().focus()}t.preventDefault();return true}var r;if(i.options.multi){r=i.value();r.push(q)}else{r=q}i.value(r);if(i._entitySetup.affector){i._entitySetup.affector([r])}j.dialog("close")});m.append(o)});if(k.length==0){g(".ua-howto").addClass("ua-warning").html(g.usosCore.lang("Brak wyników dla zapytania <span class='query'></span>. Aby zamknąć okno wciśnij klawisz Esc","No results found for <span class='query></span>. Press Esc to close this window.")).removeClass("ua-howto")}if(k.length>=20){j.append(g.usosCore.lang("<p class='ua-warning ua-focusvisible' tabindex='0'><b>Wyświetlanych jest tylko 20 najlepszych trafień.</b> Jeśli nadal nie możesz znaleźć, to zamknij okno i spróbuj doprecyzować swoje zapytanie. Na przykład, jeśli szukasz osoby, to możesz spróbować podać jej numer indeksu. Albo jeśli szukasz przedmiotu, spróbuj podać jego kod. <span class='ua-screen-reader-only'>Wciśnij klawisz Esc aby zamknąć to okno</span>","<p class='ua-warning ua-focusvisible' tabindex='0'><b>Only the best 20 matches are displayed.</b> If you still have trouble with your search then close this window and try a more specific query. For example, if you're looking for a person then you might want to try providing his/her student ID. Or, if you're looking for a course then try providing its code. <span class='ua-screen-reader-only'>Press Esc, to cancel</span>"));j.find(".ua-warning").bind("keypress keydown",function(n){if(n.keyCode==38||n.which==38){g(".ua-inline-suggestion").last().focus()}})}if(i._lastQuery){j.find(".ua-howto .query").text(i._lastQuery)}else{j.find(".ua-howto .if-query").hide().attr("aria-hidden","true")}}).fail(function(k){g.usosCore.panic(k);j.dialog("close")})}})})(jQuery);(function(a){a.widget("usosWidgets.usosTextbox",a.usosWidgets._usosValue,{options:{value:"",placeholder:null,multiline:false},widgetEventPrefix:"usostextbox:",_init:function(){var b=this;b._super("_init");b._build();b._postInit()},_build:function(){var c=this;c.element.empty();var b;var d;if(!c.options.multiline){b=a("<input type='text' class='ua-form'>");d=300}else{b=a("<textarea class='ua-form'>");d=450}c.element.append(b);if(c.options.disabled){b.prop("disabled",true)}b.css("width",(d-9)+"px");b.val(c.options.value);if(c.options.placeholder){b.attr("placeholder",a.usosCore.lang(c.options.placeholder))}c._on(b,{change:function(f){c.options.value=b.val();c._trigger("change",f)},focus:function(){if(c.options.multiline){b.autoGrow()}}})},_setOption:function(b,c){this._super(b,c);if(a.inArray(b,["placeholder","multiline"])!==-1){this._build()}else{if(b=="value"){this.element.find("input, textarea").val((c===null)?"":c)}}return this},_destroy:function(){this.element.empty();this._super("_destroy")}})})(jQuery);(function(b){b.widget("usosWidgets.usosTip",{options:{content:"",position:"top",delayed:false,type:"default",showAs:"auto",_autoWidth:true},widgetEventPrefix:"usostip:",defaultElement:"<span>",_showOnHover:null,_userContent:null,_created:false,_create:function(){var c=this;if((c.element.prop("tagName").toLowerCase()=="img")&&(!c.element.attr("alt"))){c.element.attr("alt",b.usosCore.lang("Podpowiedź","Tip"))}c.element.attr("tabindex",0);c.element.one("mouseover focus touchstart",function(){c._create2()})},_create2:function(){var f=this;if(f._created){return}f._created=true;var e=null;var d=null;if(typeof f.options.content==="function"){e=b.usosCore.lang("Wczytywanie...","Loading...");d=f.options.content}else{f._userContent=f.options.content;e=f._decideTooltipContent()}var g="ua-container ua-tooltip ";var c=0;var h=0;if(f.options.type=="tool"){g+="ua-tooltip-tool";if(f.options.position=="left"||f.options.position=="right"){c=-4}else{h=-4}}else{g+="ua-tooltip-default"}f.element.tooltipster({content:b.usosUtils._tooltipster_html(e,f.options._autoWidth),onlyOne:false,delay:f.options.delayed?500:(d?200:50),speed:0,position:f.options.position,offsetX:c,offsetY:h,updateAnimation:false,theme:g,functionReady:function(){if(d===null){return}var i=d.apply(f.element);d=null;i.done(function(k){f._userContent=k;var j=f._decideTooltipContent();f.element.tooltipster("update",b.usosUtils._tooltipster_html(j,f.options._autoWidth))}).fail(function(){var j=b.usosCore.lang("Nie udało się załadować treści podpowiedzi. Odśwież stronę i spróbuj ponownie.","Could not load the content of the tip. Refresh the page and try again.");f.element.tooltipster("update",b.usosUtils._tooltipster_html(j))})}});f._on(f.element,{focus:function(){f.element.tooltipster("show")},blur:function(){f.element.tooltipster("hide")},click:function(j,i){if(f._showOnHover){return}if(!i||(!i.fromKeypress)){f.element.trigger("blur")}f._showDialog()},keypress:function(j){var i=j.keyCode||j.which;if(i==13||i==32){j.preventDefault();j.stopPropagation();f.element.trigger("click",[{fromKeypress:true}])}}});f.element.tooltipster("show")},_showDialog:function(){var c=this;var d=b("<div class='ua-paragraphs'>").html(b.usosUtils._tooltipster_html(c._userContent,false)).css({width:"600px","overflow-y":"scroll"});d.dialog({dialogClass:"ua-panic-dialog",resizable:false,modal:true,width:"600px",height:400,closeText:b.usosCore.lang("Zamknij","Close"),open:function(e,f){b(".ui-widget-overlay").on("click",function(){b(this).siblings(".ui-dialog").find(".ui-dialog-content").dialog("close")})}})},_decideTooltipContent:function(){var f=this;var c=f._userContent;f._showOnHover=function(){if(f.options.type!="default"){return true}var g=f.options.showAs;if(g=="tooltip"){return true}else{if(g=="dialog"){return false}}if(g!="auto"){b.usosCore._console.warn("Invalid value for showAs:",g)}return(b.usosUtils._tooltipster_html(c,false).text().length<1300)}();var e;if(f._showOnHover){e=c;var d=f.element.css("cursor");if(d=="auto"||d=="text"){f.element.css("cursor","default")}}else{e=("<span class='ua-icon ua-icon-16 ua-icon-inline ua-icon-blue-prefix ua-icon-forward'></span>"+b.usosCore.lang("Kliknij, aby otworzyć...","Click to open..."));f.element.css("cursor","pointer")}return e},_setOption:function(c,e){var d=this;this._super(c,e);if(c=="content"){d._contentUpdate(b.usosUtils._tooltipster_html(d.options.content,d.options._autoWidth))}return d},_destroy:function(){this.element.tooltipster("destroy");this.element.removeAttr("tabindex")}});var a=function(){if(arguments.length==1){if(arguments[0] instanceof b){return a({content:arguments[0]})}else{if(typeof arguments[0].content!=="undefined"){}else{if((typeof arguments[0].pl!=="undefined")||(typeof arguments[0].en!=="undefined")){return a({content:arguments[0]})}else{if(typeof arguments[0]==="function"){return a({content:arguments[0]})}else{return a(arguments[0],arguments[0])}}}}}else{if(arguments.length==2){return a({content:{pl:arguments[0],en:arguments[1]}})}else{throw ("Invalid arguments")}}return b("<div class='ua-tip'><div/></div>").usosTip(arguments[0])};b.usosWidgets.usosTip.create=a})(jQuery);(function(a){var b="entity/example/spaceship";a.usosEntity._register({entityCode:b,primaryKeyFields:["spaceship_id"],getLabel:function(d){var c=a.usosUtils.requireFields(d,"id|name|class");return a("<span>").text(a.usosCore.lang(c.name)+" ("+c["class"]+")")},initBadge:function(c){return false},getSelectorSetup:false})})(jQuery);(function(a){var b="entity/courses/course";a.usosEntity._register({entityCode:b,primaryKeyFields:["course_id"],getLabel:function(c){var d=a.usosUtils.requireFields(faculty,"id|name");return a("<span>").text(a.usosCore.lang(d.name))},initBadge:function(c){return false},getSelectorSetup:function(){return{prompt:a.usosCore.lang("Wpisz nazwę przedmiotu","Enter a course name"),search:{method:"services/courses/search",paramsProvider:function(c){return{lang:a.usosCore.lang(),name:c}},itemsExtractor:function(c){return c.items}},get:{method:"services/courses/courses",paramsProvider:function(c){return{course_ids:c.join("|"),fields:"id|name"}},itemsExtractor:function(d){var c=[];a.each(d,function(f,e){if(e===null){a.usosCore._console.warn("Course "+f+" not found! Will be skipped!");return true}c.push(e)});return c}},idExtractor:function(c){return c.course_id||c.id},suggestionRenderer:function(c){return c.match},tagRenderer:function(e){var c;if(e.match){c=a("<span>").html(e.match).text();var d=c.indexOf(" ("+e.course_id+")");if(d>0){c=c.substring(0,d)}}else{c=a.usosCore.lang(e.name)}return a("<span>").text(c)}}}})})(jQuery);(function(a){var b="entity/example/spaceship";a.usosEntity._register({entityCode:b,primaryKeyFields:["spaceship_id"],getLabel:function(d){var c=a.usosUtils.requireFields(d,"id|name|class");return a("<span>").text(a.usosCore.lang(c.name)+" ("+c["class"]+")")},initBadge:function(c){return false}})})(jQuery);(function(a){var b="entity/fac/faculty";a.usosEntity._register({entityCode:b,primaryKeyFields:["fac_id"],getLabel:function(c){var d=a.usosUtils.requireFields(c,"id|name");return a("<span>").text(a.usosCore.lang(d.name)).usosBadge({entity:b,fac_id:d.id})},initBadge:function(c){this._usosFacultyBadge(c);return true},getSelectorSetup:function(){return{prompt:a.usosCore.lang("Wpisz nazwę jednostki","Enter a faculty name"),search:{method:"services/fac/search",paramsProvider:function(c){return{lang:a.usosCore.lang(),fields:"id|match|name",query:c}},itemsExtractor:function(c){return c.items}},get:{method:"services/fac/faculties",paramsProvider:function(c){return{fac_ids:c.join("|"),fields:"id|name"}},itemsExtractor:function(d){var c=[];a.each(d,function(e,f){if(f===null){a.usosCore._console.warn("Faculty "+e+" not found! Will be skipped!");return true}c.push(f)});return c}},idExtractor:function(c){return c.fac_id||c.id},suggestionRenderer:function(c){var d=a("<div>");d.html(c.match);d.usosBadge({entity:"entity/fac/faculty",fac_id:c.fac_id||c.id});return d},tagRenderer:function(d){var c=a.usosCore.lang(d.name);return a("<span>").text(c).usosBadge({entity:"entity/fac/faculty",fac_id:d.fac_id||d.id,position:"top"})}}}});a.widget("usosWidgets._usosFacultyBadge",a.usosWidgets._usosBadge,{options:{position:"top",fac_id:null},widgetEventPrefix:"usosbadge:",_getEntityKey:function(){return["fac_id"]},_cssClass:function(){return"ua-badge-fac"},_fetchData2:function(){var c=this;return a.usosCore.usosapiFetch({method:"services/fac/faculty",params:{fac_id:c.options.fac_id,fields:("id|profile_url|name|phone_numbers|homepage_url|postal_address|path[id|profile_url|name]|static_map_urls[400x200]|cover_urls[400x200]|logo_urls[100x100]|stats[programme_count|course_count|staff_count|public_subfaculty_count]")}})},_createBadge:function(c){var f=a("<div class='ua-container'><table><tr><td class='ua-stats' colspan='2'><div></div></td></tr><tr><td class='ua-cover' colspan='2'><div class='ua-cover-inner'><div class='ua-title'></div></div></td></tr><tr><td class='ua-logo'></td><td class='ua-desc'><div></div></td></tr></table></div>");if(c.cover_urls["400x200"]!=null){f.find(".ua-cover").css("background-image","url("+c.cover_urls["400x200"]+")")}else{if(c.static_map_urls["400x200"]!=null){f.find(".ua-cover").css("background-image","url("+c.static_map_urls["400x200"]+")")}}var g=f.find(".ua-title");a.each(c.path,function(l,m){g.append(a("<div class='ua-ancestor'>").html(a("<a>").attr("href",a.usosEntity.url("entity/fac/faculty",m.id)||m.profile_url).text(a.usosCore.lang(m.name))))});g.append(a("<div class='ua-name'>").html(a("<a>").attr("href",a.usosEntity.url("entity/fac/faculty",c.id)||c.profile_url).text(a.usosCore.lang(c.name))));var d=f.find(".ua-stats div");var h=a("<table class='ua-tool-num-stats'>");var k=function(m,s,p,o,l,r,q){if(s===null){return}d.append(a("<div class='ua-stat-entry'>").append(a("<span class='ua-icon ua-icon-16 ua-icon-inline'>").addClass(m)).append(a("<span>").text(s)));h.append(a("<tr>").append(a("<td>").text(s)).append(a("<td>").append(a.usosCore._nlang(s,p,o,l,r,q))))};k("ua-icon-users",c.stats.staff_count,"pracownik","pracowników","pracowników","staff member","staff members");k("ua-icon-library",c.stats.programme_count,"program studiów","programy studiów","programów studiów","study programme","study programmes");k("ua-icon-books",c.stats.course_count,"przedmiot","przedmioty","przedmiotów","course","courses");k("ua-icon-tree",c.stats.public_subfaculty_count,"podjednostka","podjednostki","podjednostek","subfaculty","subfaculties");d.usosTip({content:h,type:"tool",position:"left"});f.find(".ua-logo").append(a("<div>").append(a("<a>").attr("href",a.usosEntity.url("entity/fac/faculty",c.id)||c.profile_url).append(a("<img>").attr("src",c.logo_urls["100x100"]))));var e=f.find(".ua-desc div");if(c.postal_address||(c.phone_numbers.length>0)){var i=a("<div class='ua-address'>");e.append(i);if(c.postal_address){var j="https://maps.google.pl/?q="+encodeURIComponent(c.postal_address);i.append(a("<span>").append(a("<span>").text(c.postal_address)).append(a("<a>").attr("target","_blank").attr("href",j).html(a("<span class='ui-icon ui-icon-extlink'></span>").usosTip({type:"tool",position:"bottom",delayed:true,content:a.usosCore.lang("Pokaż w mapach Google","Show in Google Maps")}))))}if(c.phone_numbers.length>0){i.append(a("<span>").html("<span style='white-space: nowrap'>"+a.usosCore.lang("Tel: ","Phone: ")+c.phone_numbers.join(",</span> <span style='white-space: nowrap'>")))}}if(c.homepage_url){e.append(a("<a class='ua-www'>").attr("target","_blank").attr("href",c.homepage_url).text(c.homepage_url))}return f}})})(jQuery);(function(a){var b="entity/geo/building";a.usosEntity._register({entityCode:b,primaryKeyFields:["building_id"],getLabel:function(c){var d=a.usosUtils.requireFields(c,"id|name");return a("<span>").text(a.usosCore.lang(d.name)).usosBadge({entity:b,building_id:d.id})},initBadge:function(c){this._usosBuildingBadge(c);return true},getSelectorSetup:false});a.widget("usosWidgets._usosBuildingBadge",a.usosWidgets._usosBadge,{options:{building_id:null},widgetEventPrefix:"usosbadge:",_getEntityKey:function(){return["building_id"]},_cssClass:function(){return"ua-badge-building"},_fetchData2:function(){var c=this;return a.usosCore.usosapiFetch({method:"services/geo/building2",params:{building_id:c.options.building_id,langpref:a.usosCore.lang(),fields:("id|name|static_map_urls[100x100]|related_faculties|postal_address|phone_numbers|profile_url|campus_name")}})},_createBadge:function(k){var f=this;var i=a("<div><table class='ua-container'><tr><td class='ua-td1'><a class='ua-photo-link'><span class='ua-icon ua-icon-office'></span><img class='ua-photo'/></a></td><td class='ua-td2'><div class='ua-td2top'><div class='ua-name'></div><div class='ua-desc'></div></div></td></tr></table></div>");var e=k.static_map_urls["100x100"];if(e){i.find(".ua-photo").attr("src",e)}else{i.find(".ua-photo").replaceWith(a("<div class='ua-photo'>").text(a.usosCore.lang("brak mapy","no map")))}var l=a.usosEntity.url("entity/geo/building",k.id)||k.profile_url;i.find(".ua-name").html(a("<a>").attr("href",l).text(a.usosCore.lang(k.name)));if(k.campus_name){i.find(".ua-name").append(a("<div class='ua-note'>").text(a.usosCore.lang(k.campus_name)))}i.find(".ua-photo-link").attr("href",l);var h=i.find(".ua-desc");if(k.postal_address){var m="https://maps.google.pl/?q="+encodeURIComponent(k.postal_address);h.append(a("<div>").append(a("<span>").text(k.postal_address)).append(a("<a>").attr("target","_blank").attr("href",m).html(a("<span class='ui-icon ui-icon-extlink'></span>").usosTip({type:"tool",position:"bottom",delayed:true,content:a.usosCore.lang("Pokaż w mapach Google","Show in Google Maps")}))))}if(k.phone_numbers.length>0){h.append(a("<div>").text(a.usosCore.lang("Tel: ","Phone: ")+k.phone_numbers.join(", ")))}var c=k.related_faculties;var g=function(n){return n.addClass("ua-ellipsis").css("max-width","234px").on("mouseenter",function(){var o=a(this);if(this.offsetWidth<this.scrollWidth&&!o.attr("title")){o.attr("title",o.text())}})};if(c.length==1){var j=a("<div class='ua-fac'>").html(a.usosEntity.link("entity/fac/faculty",c[0]));h.append(j)}else{if(c.length>1){var d=a("<div>");a.each(c,function(n,o){d.append(g(a.usosEntity.label("entity/fac/faculty",o)))});var j=a("<a class='ua-link ua-no-underline'>").attr("href",l);h.append(a("<div class='ua-fac'>").append(j));j.append(c.length+" ").append(a.usosCore._nlang(c.length,"związana jednostka","związane jednostki","związanych jednostek","related faculty","related faculties")).usosTip({content:d,position:"bottom",type:"tool",_autoWidth:false})}}return i}})})(jQuery);(function(a){var b="entity/progs/programme";a.usosEntity._register({entityCode:b,primaryKeyFields:["programme_id"],getLabel:function(c){var d=a.usosUtils.requireFields(c,"id|description");return a("<span>").text(a.usosCore.lang(d.description))},initBadge:function(c){return false},getSelectorSetup:function(){return{prompt:a.usosCore.lang("Wpisz nazwę programu","Enter a programme name"),search:{method:"services/progs/search",paramsProvider:function(c){return{lang:a.usosCore.lang(),fields:"items[match|programme[id|name|faculty[name|logo_urls[50x50]]]]|next_page",query:c,num:4}},itemsExtractor:function(c){return c.items}},get:{method:"services/progs/programmes",paramsProvider:function(c){return{programme_ids:c.join("|"),fields:"id|name"}},itemsExtractor:function(d){var c=[];a.each(d,function(f,e){if(e===null){a.usosCore._console.warn("Programme "+f+" not found! Will be skipped!");return true}c.push({match:null,programme:e})});return c}},idExtractor:function(c){return c.programme.id},suggestionRenderer:function(c){var d=a("<div class='ua-programmesuggestion'><table><tr><td class='ua-td1'><img/></td><td class='ua-td2'><div class='ua-match'></div><div class='ua-tagline'></div></td></tr></table></div>");d.find(".ua-match").html(c.match);d.find("img").attr("src",c.programme.faculty.logo_urls["50x50"]);if(d.find(".ua-match").text().indexOf(c.programme.id)==-1){d.find(".ua-match").append(" ");d.find(".ua-match").append(a("<span class='ua-note'>").text(c.programme.id))}d.find(".ua-tagline").append(a("<span class='ua-note'>").text(a.usosCore.lang(c.programme.faculty.name)));return d},affector:function(c){a.each(c,function(d,e){a.usosCore.usosapiFetch({method:"services/progs/search_history_affect",params:{programme_id:e}})})},tagRenderer:function(d){var c=a.usosCore.lang(d.programme.name);return a("<span>").text(c)}}}})})(jQuery);(function(a){var b="entity/slips/template";a.usosEntity._register({entityCode:b,primaryKeyFields:["tpl_id"],getLabel:function(c){var d=a.usosUtils.requireFields(c,"id|name");return a("<span>").text(a.usosCore.lang(d.name))},initBadge:function(c){return false},getSelectorSetup:function(){return{prompt:a.usosCore.lang("Wpisz nazwę szablonu obiegówki","Enter a slip template name"),search:{method:"services/slips/search_templates",paramsProvider:function(c){return{langpref:a.usosCore.lang(),fields:"id|match|name|state",query:c}},itemsExtractor:function(c){return c.items}},get:{method:"services/slips/templates",paramsProvider:function(c){return{tpl_ids:c.join("|"),fields:"id|name"}},itemsExtractor:function(d){var c=[];a.each(d,function(f,e){if(e===null){a.usosCore._console.warn("Template "+f+" not found! Will be skipped!");return true}c.push(e)});return c}},idExtractor:function(c){return c.id},suggestionRenderer:function(d){var c=a("<div>");c.append(a("<span>").html(d.match));if(d.state!="active"){c.append(" ").append(a("<span class='ua-note'>").text(d.state=="draft"?a.usosCore.lang("(kopia robocza)","(draft)"):a.usosCore.lang("(przestarzały)","(obsolete)")))}return c},tagRenderer:function(c){return a("<span>").text(c.name).click(function(){var d=a.usosEntity.url("entity/slips/template",c.id);if(!d){return}var e=a.usosCore.lang('Przejść do strony szablonu "'+c.name+'"?','Go to the "'+c.name+'" template page?');if(confirm(e)){document.location=d}})}}}})})(jQuery);(function(a){var b="entity/users/user";a.usosEntity._register({entityCode:b,primaryKeyFields:["user_id"],getLabel:function(c){var d=a.usosUtils.requireFields(c,"id|first_name|last_name");return a("<span>").text(d.first_name+" "+d.last_name).usosBadge({entity:b,user_id:d.id})},initBadge:function(c){this._usosUserBadge(c);return true},getSelectorSetup:function(){var c=("id|sex|first_name|last_name|employment_functions[function|faculty|is_official]|student_programmes[programme|status]|employment_positions|photo_urls[50x50]");return{prompt:a.usosCore.lang("Wpisz imię i nazwisko","Enter the user's name"),search:{method:"services/users/search2",paramsProvider:function(d){return{lang:a.usosCore.lang(),query:d,num:4,fields:"items[match|user["+c+"]]"}},itemsExtractor:function(d){return d.items}},get:{method:"services/users/users",paramsProvider:function(d){return{user_ids:d.join("|"),fields:c}},itemsExtractor:function(e){var d=[];a.each(e,function(f,g){if(g===null){a.usosCore._console.warn("User "+f+" not found! Will be skipped!");return true}d.push({user:g})});return d}},idExtractor:function(d){return d.user.id},suggestionRenderer:function(e){var d=a("<div class='ua-usersuggestion'><table><tr><td class='ua-td1'><img alt=''/></td><td class='ua-td2'><div class='ua-match'></div><div class='ua-tagline'></div></td></tr></table></div>");d.find(".ua-match").html(e.match);d.find("img").attr("src",e.user.photo_urls["50x50"]);a.each(e.user.employment_positions,function(g,h){d.find(".ua-tagline").append(a("<span class='ua-note'>").text(a.usosCore.lang(h.position.name)+" ("+a.usosCore.lang(h.faculty.name)+")")).append(" ")});a.each(e.user.employment_functions,function(g,h){if(!h.is_official){return}d.find(".ua-tagline").append(a("<span class='ua-note'>").text(a.usosCore.lang(h["function"])+" ("+a.usosCore.lang(h.faculty.name)+")")).append(" ")});var f=[];a.each(e.user.student_programmes,function(g,h){if((h.status=="active")||(h.status=="graduated_before_diploma")){f.push(h)}});if(e.user.student_programmes.length>0){if(f.length>0){a.each(f,function(g,h){d.find(".ua-tagline").append(a("<span class='ua-note'>").text(a.usosCore.lang(h.programme.description))).append(" ")})}else{d.find(".ua-tagline").append(a("<span class='ua-note'>").text(a.usosCore.lang((e.user.sex=="M")?"Były student":"Była studentka","Ex-student"))).append(" ")}}d.usosBadge({entity:"entity/users/user",user_id:e.user.id});return d},affector:function(d){a.each(d,function(f,e){a.usosCore.usosapiFetch({method:"services/users/search_history_affect",params:{user_id:e}})})},tagRenderer:function(d){return a("<span>").text(d.user.first_name+" "+d.user.last_name).usosBadge({entity:"entity/users/user",user_id:d.user.id,position:"top"})}}}});a.widget("usosWidgets._usosUserBadge",a.usosWidgets._usosBadge,{options:{user_id:null},widgetEventPrefix:"usosbadge:",_getEntityKey:function(){return["user_id"]},_cssClass:function(){return"ua-badge-user"},_fetchData2:function(){var d=this;var e=a.usosEntity.url("entity/users/user",d.options.user_id);var c=("id|first_name|last_name|photo_urls[100x100]|sex|employment_functions[function|faculty|is_official]|employment_positions|student_programmes[programme|status]|student_number");if(!e){c+="|profile_url"}return a.usosCore.usosapiFetch({method:"services/users/user",params:{user_id:d.options.user_id,fields:c}}).then(function(f){if(e){f.profile_url=e}return f})},_createBadge:function(e){var g=this;var k=a("<div><table class='ua-container'><tr><td class='ua-td1'><a class='ua-photo-link'><img class='ua-photo' alt=''/></a></td><td class='ua-td2'><div class='ua-td2top'><div class='ua-id-icon'>id</div><div class='ua-name'></div><ul class='ua-functions'></ul></div></td></tr></table></div>");k.find(".ua-photo").attr("src",e.photo_urls["100x100"]);k.find(".ua-name").html(a("<a>").attr("href",e.profile_url).text(e.first_name+" "+e.last_name));if(e.student_number){k.find(".ua-name").append(a("<span class='ua-student-number'>").text(e.student_number).css("cursor","default").usosTip({type:"tool",position:"top",content:{pl:"Numer albumu",en:"Student number"}}))}k.find(".ua-photo-link").attr("href",e.profile_url);var j=function(m){return m.addClass("ua-ellipsis").css("max-width","234px").on("mouseenter",function(){var n=a(this);if(this.offsetWidth<this.scrollWidth&&!n.attr("title")){n.attr("title",n.text())}})};var d={};a.each(e.employment_functions,function(m,n){if(!n.is_official){return}if(!d.hasOwnProperty(n.faculty.id)){d[n.faculty.id]={faculty:n.faculty,names:[]}}d[n.faculty.id].names.push(n["function"])});a.each(e.employment_positions,function(m,n){if(!d.hasOwnProperty(n.faculty.id)){d[n.faculty.id]={faculty:n.faculty,names:[]}}d[n.faculty.id].names.push(n.position.name)});a.each(d,function(n,o){var m;var p=a.usosEntity.link("entity/fac/faculty",o.faculty);if(o.names.length==1&&p.text().length+a.usosCore.lang(o.names[0]).length<45){m=a("<li>").append(j(a("<div>").append(p).append(" - ").append(a("<span class='ua-func'>").text(a.usosCore.lang(o.names[0])))))}else{m=a("<li>").append(j(p));o.names.sort(function(r,q){return r.length>q.length?-1:1});a.each(o.names,function(r,q){m.append(j(a("<span class='ua-func'>").text(a.usosCore.lang(q))))})}k.find(".ua-functions").append(m)});var f=[];var c=[];a.each(e.student_programmes,function(m,n){if(n.status=="active"||n.status=="graduated_before_diploma"){f.push(n)}else{c.push(n)}});var h=function(n,m){var r=a("<div>");var o=0;var q={};a.each(n,function(s,t){var u=t.programme.id;if(!q.hasOwnProperty(u)){q[u]=true;o++;r.append(j(a.usosEntity.label("entity/progs/programme",t.programme)))}});m.append(a.usosCore.lang(" (na "," (on "));var p=a("<span class='ua-link ua-no-underline'>");m.append(p);p.append(o+" ").append(a.usosCore.lang("programach","programmes")).usosTip({content:r,position:"bottom",type:"tool",_autoWidth:false});m.append(")")};if(f.length>0){var l=a("<li>").append(a.usosCore.lang(e.sex=="M"?"Student":"Studentka","Student"));if(f.length>3){h(f,l)}else{a.each(f,function(m,n){l.append(j(a.usosEntity.link("entity/progs/programme",n.programme)))})}k.find(".ua-functions").append(l)}if(c.length>0){var l=a("<li>").append(a.usosCore.lang(e.sex=="M"?"Były student":"Była studentka","Ex-student"));if(c.length>1){h(c,l)}else{a.each(c,function(m,n){l.append(j(a.usosEntity.link("entity/progs/programme",n.programme)))})}k.find(".ua-functions").append(l)}if(e.id==a.usosCore._getSettings().usosAPIs["default"].user_id){k.find(".ua-td2").append(a("<div class='ua-privacy-note'>").append(a("<span>").append(":: ").append(a("<span class='ua-link ua-no-underline'>").text(a.usosCore.lang("Kto może oglądać moje zdjęcie?","Who can see my photo?")).usosTip({content:function(){return a.usosCore.usosapiFetch({method:"services/photos/my_photo_visibility"}).then(function(n){var m=a("<div>").css("max-width","200px");m.append(a("<p>").text(a.usosCore.lang(n.desc_for_user)));m.append(a("<p>").text(a.usosCore.lang("Widoczność zdjęcia możesz zmienić na stronie preferencji w USOSweb.","You can change this visibility in your USOSweb preferences page.")));return m})},position:"bottom",type:"tool",_autoWidth:false}))))}var i=function(){var m=null;return function(){if(m!=null){return m}m=a.usosCore.usosapiFetch({method:"services/users/user",params:{user_id:e.id,fields:("id|first_name|middle_names|last_name|previous_names|sex|email|phone_numbers|mobile_numbers|student_number|pesel")}}).then(function(o){var n=a("<table cellspacing='0' style='width: 100%'>");var p=function(s,r){var q;if(!r){return}if(a.isArray(r)){if(r.length==0){return}q=a("<div>");a.each(r,function(u,t){q.append(a("<div>").text(t))})}else{if((typeof r==="string")||(typeof r==="number")){q=a("<div>").text(r)}else{if(r instanceof a){q=r}else{a.usosCore._console.error("Unknown value type",r);return}}}n.append(a("<tr>").append(a("<td style='padding: 0 4px 0 0; white-space: nowrap; font-weight: bold; text-align: right; vertical-align: top'>").text(s+":")).append(a("<td style='padding: 0 0 0 0; white-space: nowrap; vertical-align: top'>").append(q)))};p(a.usosCore.lang("Numer PESEL","PESEL number"),o.pesel);p(a.usosCore.lang("Numer albumu","Student number"),o.student_number);p(a.usosCore.lang("Imię","First name"),o.first_name);p(a.usosCore.lang("Drugie imię","Middle names"),o.middle_names);p(a.usosCore.lang("Nazwisko","Last name"),o.last_name);p(a.usosCore.lang("Poprzednie nazwiska","Previous names"),function(){if(!o.previous_names){return null}if(o.previous_names.length===0){return null}var q=a("<div>");a.each(o.previous_names,function(r,s){q.append(a("<div>").text(s.first_name+" "+s.last_name+" "+a.usosCore.lang("(do "+s.until+")","(until "+s.until+")")))});return q}());p(a.usosCore.lang("Adres e-mail","Email address"),o.email);p("USOS ID",o.id);p(a.usosCore.lang("Płeć","Sex"),o.sex=="M"?a.usosCore.lang("mężczyzna","male"):a.usosCore.lang("kobieta","female"));p(a.usosCore.lang("Numery telefonów","Phone numbers"),o.phone_numbers);p(a.usosCore.lang("Numery prywatne","Private mobile numbers"),o.mobile_numbers);return n});return m}}();k.find(".ua-id-icon").usosTip({type:"tool",position:"right",_autoWidth:false,content:i}).on("click",function(){i().done(function(m){g.element.tooltipster("hide");var n=a("<div class='ua-paragraphs'>");n.append(m);n.append(a("<p style='text-align: center'>").append(a("<a class='ua-link'>").text(a.usosCore.lang("Zamknij","Close"))));n.dialog({dialogClass:"ua-panic-dialog ua-scrollable ua-selector-popup",resizable:false,modal:true,width:"auto",height:"auto",closeText:a.usosCore.lang("Zamknij","Close"),close:function(){try{n.usosProgressOverlay("destroy")}catch(o){}},show:{effect:"fade",duration:300},hide:{effect:"fade",duration:100}});n.find("a").on("click",function(){n.dialog("close")})})});return k}})})(jQuery);